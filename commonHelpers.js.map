{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nasync function serviceGetImage({ query, page = 1 }) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '43229281-da9ce3bce46360bd3cf91ebb8';\n\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n  };\n\n  const { data } = await axios(BASE_URL, { params: { ...params, page } });\n  return data;\n}\n\nexport { serviceGetImage };\n","function createImageMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"list-item\">\n      <a class=\"item-link\" href=\"${largeImageURL}\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\"></a>\n      <div class=\"img-desc\">\n        <p class=\"prop\">Likes <span class=\"value\">${likes}</span></p>\n        <p class=\"prop\">Views <span class=\"value\">${views}</span></p>\n        <p class=\"prop\">Comments <span class=\"value\">${comments}</span></p>\n        <p class=\"prop\">Downloads <span class=\"value\">${downloads}</span></p>\n      </div>\n      \n      </li>`\n    )\n    .join('');\n}\n\nexport { createImageMarkup };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { serviceGetImage } from './js/pixabay-api';\nimport { createImageMarkup } from './js/render-functions';\n\nconst form = document.querySelector('.js-form');\nconst loader = document.querySelector('.preloader');\nconst gallery = document.querySelector('.js-list');\nconst loadMoreButton = document.querySelector('.btn-load-more');\n\nform.addEventListener('submit', handlerSearch);\nloadMoreButton.addEventListener('click', handleMoreLoadClick);\n\nconst modal = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n});\n\nlet page = 1;\nlet query = '';\nlet lastPage;\n\nasync function handlerSearch(event) {\n  event.preventDefault();\n  page = 1;\n  gallery.innerHTML = '';\n  query = event.target.elements.query.value.trim().toLowerCase();\n  if (!query) {\n    iziToast.warning({\n      message: 'Please input your request',\n      position: 'topRight',\n    });\n    return;\n  }\n  loader.classList.remove('is-hidden');\n  loadMoreButton.classList.add('is-hidden');\n  try {\n    const data = await serviceGetImage({ query, page });\n    checkLastPage(data.totalHits);\n\n    if (!data.hits.length) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: 'red',\n        messageColor: '#fff',\n      });\n      return;\n    }\n    gallery.innerHTML = createImageMarkup(data.hits);\n\n    modal.refresh();\n  } catch (err) {\n    err.statusText;\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n\n  event.target.reset();\n}\n\nasync function handleMoreLoadClick(event) {\n  page += 1;\n  loader.classList.remove('is-hidden');\n  try {\n    const data = await serviceGetImage({ query, page });\n\n    checkLastPage(data.totalHits);\n\n    gallery.insertAdjacentHTML('beforeend', createImageMarkup(data.hits));\n    scrollGallery();\n\n    modal.refresh();\n  } catch (err) {\n    err.statusText;\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n}\n\nfunction scrollGallery() {\n  const galleryItem = gallery.querySelector('.list-item');\n  if (!galleryItem) {\n    return;\n  }\n  const { height } = galleryItem.getBoundingClientRect();\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction checkLastPage(totalHits) {\n  lastPage = Math.ceil(totalHits / 15);\n  if (page < lastPage) {\n    loadMoreButton.classList.remove('is-hidden');\n  } else if (page === lastPage) {\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n      backgroundColor: 'blue',\n      messageColor: '#000',\n    });\n    loadMoreButton.classList.add('is-hidden');\n  }\n}\n"],"names":["serviceGetImage","query","page","BASE_URL","params","data","axios","createImageMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","loader","gallery","loadMoreButton","handlerSearch","handleMoreLoadClick","modal","SimpleLightbox","lastPage","event","iziToast","checkLastPage","err","scrollGallery","galleryItem","height","totalHits"],"mappings":"owBAEA,eAAeA,EAAgB,CAAE,MAAAC,EAAO,KAAAC,EAAO,CAAC,EAAI,CAClD,MAAMC,EAAW,2BAGXC,EAAS,CACb,IAHc,qCAId,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACd,EAEQ,CAAE,KAAAI,CAAI,EAAK,MAAMC,EAAMH,EAAU,CAAE,OAAQ,CAAE,GAAGC,EAAQ,KAAAF,CAAI,CAAI,CAAA,EACtE,OAAOG,CACT,CCjBA,SAASE,EAAkBC,EAAK,CAC9B,OAAOA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,IACC;AAAA,mCAC2BL,CAAa;AAAA,kBAC9BD,CAAY,UAAUE,CAAI;AAAA;AAAA,oDAEQC,CAAK;AAAA,oDACLC,CAAK;AAAA,uDACFC,CAAQ;AAAA,wDACPC,CAAS;AAAA;AAAA;AAAA,YAI5D,EACA,KAAK,EAAE,CACZ,CChBA,MAAMC,EAAO,SAAS,cAAc,UAAU,EACxCC,EAAS,SAAS,cAAc,YAAY,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAiB,SAAS,cAAc,gBAAgB,EAE9DH,EAAK,iBAAiB,SAAUI,CAAa,EAC7CD,EAAe,iBAAiB,QAASE,CAAmB,EAE5D,MAAMC,EAAQ,IAAIC,EAAe,aAAc,CAC7C,aAAc,GAChB,CAAC,EAED,IAAIrB,EAAO,EACPD,EAAQ,GACRuB,EAEJ,eAAeJ,EAAcK,EAAO,CAKlC,GAJAA,EAAM,eAAc,EACpBvB,EAAO,EACPgB,EAAQ,UAAY,GACpBjB,EAAQwB,EAAM,OAAO,SAAS,MAAM,MAAM,OAAO,cAC7C,CAACxB,EAAO,CACVyB,EAAS,QAAQ,CACf,QAAS,4BACT,SAAU,UAChB,CAAK,EACD,MACD,CACDT,EAAO,UAAU,OAAO,WAAW,EACnCE,EAAe,UAAU,IAAI,WAAW,EACxC,GAAI,CACF,MAAMd,EAAO,MAAML,EAAgB,CAAE,MAAAC,EAAO,KAAAC,CAAM,CAAA,EAGlD,GAFAyB,EAActB,EAAK,SAAS,EAExB,CAACA,EAAK,KAAK,OAAQ,CACrBqB,EAAS,MAAM,CACb,QACE,2EACF,SAAU,WACV,gBAAiB,MACjB,aAAc,MACtB,CAAO,EACD,MACD,CACDR,EAAQ,UAAYX,EAAkBF,EAAK,IAAI,EAE/CiB,EAAM,QAAO,CACd,OAAQM,EAAK,CACZA,EAAI,UACR,QAAY,CACRX,EAAO,UAAU,IAAI,WAAW,CACjC,CAEDQ,EAAM,OAAO,OACf,CAEA,eAAeJ,EAAoBI,EAAO,CACxCvB,GAAQ,EACRe,EAAO,UAAU,OAAO,WAAW,EACnC,GAAI,CACF,MAAMZ,EAAO,MAAML,EAAgB,CAAE,MAAAC,EAAO,KAAAC,CAAM,CAAA,EAElDyB,EAActB,EAAK,SAAS,EAE5Ba,EAAQ,mBAAmB,YAAaX,EAAkBF,EAAK,IAAI,CAAC,EACpEwB,IAEAP,EAAM,QAAO,CACd,OAAQM,EAAK,CACZA,EAAI,UACR,QAAY,CACRX,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,CAEA,SAASY,GAAgB,CACvB,MAAMC,EAAcZ,EAAQ,cAAc,YAAY,EACtD,GAAI,CAACY,EACH,OAEF,KAAM,CAAE,OAAAC,CAAM,EAAKD,EAAY,sBAAqB,EACpD,OAAO,SAAS,CACd,IAAKC,EAAS,EACd,SAAU,QACd,CAAG,CACH,CAEA,SAASJ,EAAcK,EAAW,CAChCR,EAAW,KAAK,KAAKQ,EAAY,EAAE,EAC/B9B,EAAOsB,EACTL,EAAe,UAAU,OAAO,WAAW,EAClCjB,IAASsB,IAClBE,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,gBAAiB,OACjB,aAAc,MACpB,CAAK,EACDP,EAAe,UAAU,IAAI,WAAW,EAE5C"}